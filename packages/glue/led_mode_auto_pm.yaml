# REQUIRES substitutions:
#   led_light_id        (example: onboard_led)
#   pm_worst_level_id   (example: sps30_pm_worst_level)

interval:
  - interval: 5s
    then:
      - if:
          condition:
            lambda: 'return id(led_mode).state == "auto_pm";'
          then:
            - lambda: |-
                auto s = id(${pm_worst_level_id}).state;

                if (s == "Green")  { id(${led_light_id}).turn_on().set_brightness(0.35).set_rgb(0.0, 1.0, 0.0).perform(); return; }
                if (s == "Yellow") { id(${led_light_id}).turn_on().set_brightness(0.35).set_rgb(1.0, 1.0, 0.0).perform(); return; }
                if (s == "Orange") { id(${led_light_id}).turn_on().set_brightness(0.35).set_rgb(1.0, 0.55, 0.0).perform(); return; }
                if (s == "Red")    { id(${led_light_id}).turn_on().set_brightness(0.35).set_rgb(1.0, 0.0, 0.0).perform(); return; }

                id(${led_light_id}).turn_on().set_brightness(0.20).set_rgb(0.0, 0.0, 1.0).perform();